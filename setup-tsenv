#!/bin/bash -eu

# usage:
#     setup-tsenv [<directory>]

# determine target dir by arg or current dir
TARGET_DIR=$(pwd)
if [ ${#} -eq 1 ]; then
  TARGET_DIR=${1}
fi

# move to directory
mkdir -p ${TARGET_DIR}
cd ${TARGET_DIR}

# setup Node environment
cat << EOT >> package.json
{
  "name": "hello",
  "version": "1.0.0",
  "description": "",
  "main": "main.js",
  "scripts": {
    "build": "tsc main.ts",
    "main": "node main.js"
  },
  "keywords": [],
  "author": "",
  "license": "ISC",
  "devDependencies": {
    "typescript": "^2.0.6"
  }
}
EOT

npm install

# setup TypeScript environment
cat << EOT >> tsconfig.json
{
    "files": ["main.ts"],
    "filesGlob": ["*.ts"],
    "compilerOptions": {
        "noImplicitAny": true,
        "target": "es6"
    }
}
EOT

# create blank source
cat << EOT >> main.ts
console.log("Hello world!");
EOT
